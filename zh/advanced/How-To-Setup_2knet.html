<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>如何启动测试网络 | 启明星</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/assets/venus-logo.png">
    <meta name="description" content="GO语言实现的Filecoin分布式存储网络">
    
    <link rel="preload" href="/assets/css/0.styles.117964e0.css" as="style"><link rel="preload" href="/assets/js/app.c54dbfd7.js" as="script"><link rel="preload" href="/assets/js/2.975ccc2c.js" as="script"><link rel="preload" href="/assets/js/60.376cfae0.js" as="script"><link rel="prefetch" href="/assets/js/10.d99f1032.js"><link rel="prefetch" href="/assets/js/100.8d331781.js"><link rel="prefetch" href="/assets/js/101.beff7747.js"><link rel="prefetch" href="/assets/js/102.1cb5365a.js"><link rel="prefetch" href="/assets/js/103.72c48bd4.js"><link rel="prefetch" href="/assets/js/104.f36406a6.js"><link rel="prefetch" href="/assets/js/105.c54b8e6a.js"><link rel="prefetch" href="/assets/js/106.02279486.js"><link rel="prefetch" href="/assets/js/107.5a8c8f29.js"><link rel="prefetch" href="/assets/js/108.ec8b391b.js"><link rel="prefetch" href="/assets/js/11.73ea5553.js"><link rel="prefetch" href="/assets/js/12.dfb2b0dc.js"><link rel="prefetch" href="/assets/js/13.0680ea6b.js"><link rel="prefetch" href="/assets/js/14.ffe3b738.js"><link rel="prefetch" href="/assets/js/15.27d31e41.js"><link rel="prefetch" href="/assets/js/16.267b0382.js"><link rel="prefetch" href="/assets/js/17.e891a041.js"><link rel="prefetch" href="/assets/js/18.04c9a8ca.js"><link rel="prefetch" href="/assets/js/19.a76c25be.js"><link rel="prefetch" href="/assets/js/20.5bae2206.js"><link rel="prefetch" href="/assets/js/21.4205f0a9.js"><link rel="prefetch" href="/assets/js/22.344f9938.js"><link rel="prefetch" href="/assets/js/23.bacd5c71.js"><link rel="prefetch" href="/assets/js/24.e109a378.js"><link rel="prefetch" href="/assets/js/25.265f266c.js"><link rel="prefetch" href="/assets/js/26.0fc597fa.js"><link rel="prefetch" href="/assets/js/27.2157521b.js"><link rel="prefetch" href="/assets/js/28.fddec8a8.js"><link rel="prefetch" href="/assets/js/29.c5c6421e.js"><link rel="prefetch" href="/assets/js/3.b200c0b1.js"><link rel="prefetch" href="/assets/js/30.e7d43314.js"><link rel="prefetch" href="/assets/js/31.fbc0534d.js"><link rel="prefetch" href="/assets/js/32.c3a7f0fb.js"><link rel="prefetch" href="/assets/js/33.d47ea0fb.js"><link rel="prefetch" href="/assets/js/34.7c1bed54.js"><link rel="prefetch" href="/assets/js/35.d26e1942.js"><link rel="prefetch" href="/assets/js/36.ef57e362.js"><link rel="prefetch" href="/assets/js/37.eaed74a4.js"><link rel="prefetch" href="/assets/js/38.d6de25d0.js"><link rel="prefetch" href="/assets/js/39.bed424dc.js"><link rel="prefetch" href="/assets/js/4.4e64739e.js"><link rel="prefetch" href="/assets/js/40.ea675ba6.js"><link rel="prefetch" href="/assets/js/41.bd52f078.js"><link rel="prefetch" href="/assets/js/42.72617127.js"><link rel="prefetch" href="/assets/js/43.db399951.js"><link rel="prefetch" href="/assets/js/44.7e6daa16.js"><link rel="prefetch" href="/assets/js/45.ab3f96f6.js"><link rel="prefetch" href="/assets/js/46.68aec4fd.js"><link rel="prefetch" href="/assets/js/47.ea345beb.js"><link rel="prefetch" href="/assets/js/48.f7b9ee77.js"><link rel="prefetch" href="/assets/js/49.86847a46.js"><link rel="prefetch" href="/assets/js/5.34fedeab.js"><link rel="prefetch" href="/assets/js/50.fbc69b91.js"><link rel="prefetch" href="/assets/js/51.2e2d1175.js"><link rel="prefetch" href="/assets/js/52.63baa94f.js"><link rel="prefetch" href="/assets/js/53.d1ac523a.js"><link rel="prefetch" href="/assets/js/54.e9b017f5.js"><link rel="prefetch" href="/assets/js/55.3d057392.js"><link rel="prefetch" href="/assets/js/56.8f34b48c.js"><link rel="prefetch" href="/assets/js/57.b434c744.js"><link rel="prefetch" href="/assets/js/58.218aa5a7.js"><link rel="prefetch" href="/assets/js/59.6d58bad3.js"><link rel="prefetch" href="/assets/js/6.1fe13b4e.js"><link rel="prefetch" href="/assets/js/61.7dcad05d.js"><link rel="prefetch" href="/assets/js/62.779db623.js"><link rel="prefetch" href="/assets/js/63.dd181b08.js"><link rel="prefetch" href="/assets/js/64.a106d972.js"><link rel="prefetch" href="/assets/js/65.76a83247.js"><link rel="prefetch" href="/assets/js/66.a978d6ed.js"><link rel="prefetch" href="/assets/js/67.767823e1.js"><link rel="prefetch" href="/assets/js/68.f93570ee.js"><link rel="prefetch" href="/assets/js/69.76853429.js"><link rel="prefetch" href="/assets/js/7.7853ea60.js"><link rel="prefetch" href="/assets/js/70.e5cb5a0b.js"><link rel="prefetch" href="/assets/js/71.8760857b.js"><link rel="prefetch" href="/assets/js/72.294655aa.js"><link rel="prefetch" href="/assets/js/73.57e68a01.js"><link rel="prefetch" href="/assets/js/74.15af5e7d.js"><link rel="prefetch" href="/assets/js/75.40344dd1.js"><link rel="prefetch" href="/assets/js/76.606c3574.js"><link rel="prefetch" href="/assets/js/77.8b0e510a.js"><link rel="prefetch" href="/assets/js/78.fd807fae.js"><link rel="prefetch" href="/assets/js/79.4351b51b.js"><link rel="prefetch" href="/assets/js/8.9ecdec9c.js"><link rel="prefetch" href="/assets/js/80.0d7c4a5a.js"><link rel="prefetch" href="/assets/js/81.1e2a4c4c.js"><link rel="prefetch" href="/assets/js/82.699b30a9.js"><link rel="prefetch" href="/assets/js/83.25138a77.js"><link rel="prefetch" href="/assets/js/84.033e3036.js"><link rel="prefetch" href="/assets/js/85.5b4b565d.js"><link rel="prefetch" href="/assets/js/86.5837a385.js"><link rel="prefetch" href="/assets/js/87.0becf39f.js"><link rel="prefetch" href="/assets/js/88.fa1da309.js"><link rel="prefetch" href="/assets/js/89.a1214f47.js"><link rel="prefetch" href="/assets/js/9.41a25c3d.js"><link rel="prefetch" href="/assets/js/90.850bb30a.js"><link rel="prefetch" href="/assets/js/91.59cacdf1.js"><link rel="prefetch" href="/assets/js/92.71a9f18e.js"><link rel="prefetch" href="/assets/js/93.6c5092cf.js"><link rel="prefetch" href="/assets/js/94.b222a1eb.js"><link rel="prefetch" href="/assets/js/95.30c84a96.js"><link rel="prefetch" href="/assets/js/96.791fd09b.js"><link rel="prefetch" href="/assets/js/97.f81106e7.js"><link rel="prefetch" href="/assets/js/98.5feec3f0.js"><link rel="prefetch" href="/assets/js/99.2ea54e04.js">
    <link rel="stylesheet" href="/assets/css/0.styles.117964e0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zh/" class="home-link router-link-active"><img src="/assets/venus-logo-title.svg" alt="启明星" class="logo"> <span class="site-name can-hide">启明星</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/zh/guide/" class="nav-link">
  快速上手
</a></div><div class="nav-item"><a href="/zh/modules/" class="nav-link">
  组件模块
</a></div><div class="nav-item"><a href="/zh/advanced/" class="nav-link router-link-active">
  进阶
</a></div><div class="nav-item"><a href="/zh/operation/" class="nav-link">
  运维
</a></div><div class="nav-item"><a href="/zh/incubation/" class="nav-link">
  孵化器
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/How-To-Setup_2knet.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh/advanced/How-To-Setup_2knet.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/zh/guide/" class="nav-link">
  快速上手
</a></div><div class="nav-item"><a href="/zh/modules/" class="nav-link">
  组件模块
</a></div><div class="nav-item"><a href="/zh/advanced/" class="nav-link router-link-active">
  进阶
</a></div><div class="nav-item"><a href="/zh/operation/" class="nav-link">
  运维
</a></div><div class="nav-item"><a href="/zh/incubation/" class="nav-link">
  孵化器
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/How-To-Setup_2knet.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh/advanced/How-To-Setup_2knet.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zh/advanced/" aria-current="page" class="sidebar-link">venus矿池进阶</a></li><li><a href="/zh/advanced/How-To-Setup_2knet.html" aria-current="page" class="active sidebar-link">如何搭建私网</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/advanced/How-To-Setup_2knet.html#服务组件搭建" class="sidebar-link">服务组件搭建</a></li><li class="sidebar-sub-header"><a href="/zh/advanced/How-To-Setup_2knet.html#创世节点" class="sidebar-link">创世节点</a></li><li class="sidebar-sub-header"><a href="/zh/advanced/How-To-Setup_2knet.html#普通节点" class="sidebar-link">普通节点</a></li></ul></li><li><a href="/zh/advanced/tips-running-in-China.html" class="sidebar-link">中国部署小贴士</a></li><li><a href="/zh/advanced/Venus-Project-Dependency-Upgrade.html" class="sidebar-link">venus组件依赖与升级</a></li><li><a href="/zh/advanced/venus-cli.html" class="sidebar-link">CLI命令</a></li><li><a href="/zh/advanced/Multisig-Wallet.html" class="sidebar-link">多签钱包</a></li><li><a href="/zh/advanced/venus_load_balancing.html" class="sidebar-link">负载均衡</a></li><li><a href="/zh/advanced/Payment-Channel.html" class="sidebar-link">支付通道</a></li><li><a href="/zh/advanced/How-To-Setup_2knet.html" aria-current="page" class="active sidebar-link">本地2k开发网络</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/advanced/How-To-Setup_2knet.html#服务组件搭建" class="sidebar-link">服务组件搭建</a></li><li class="sidebar-sub-header"><a href="/zh/advanced/How-To-Setup_2knet.html#创世节点" class="sidebar-link">创世节点</a></li><li class="sidebar-sub-header"><a href="/zh/advanced/How-To-Setup_2knet.html#普通节点" class="sidebar-link">普通节点</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="如何启动测试网络"><a href="#如何启动测试网络" class="header-anchor">#</a> 如何启动测试网络</h1> <blockquote><p>本文以建立2k网络为例,在 CentOS 7.* 系统部署venus集群.</p></blockquote> <h2 id="服务组件搭建"><a href="#服务组件搭建" class="header-anchor">#</a> 服务组件搭建</h2> <p>   组件下载及编译请参考文档：https://venus.filecoin.io/guide/How-To-Deploy-MingPool.html#pre-requisites</p> <h3 id="venus-auth"><a href="#venus-auth" class="header-anchor">#</a> venus-auth</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">nohup</span> ./venus-auth run <span class="token operator">&gt;</span> auth.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>

<span class="token comment"># token列表</span>
$ ./venus-auth token list
 
<span class="token comment"># user列表</span>
$ ./venus-auth user list
</code></pre></div><h3 id="venus-gateway"><a href="#venus-gateway" class="header-anchor">#</a> venus-gateway</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">nohup</span> ./venus-gateway --listen<span class="token operator">=</span>/ip4/0.0.0.0/tcp/45132 run --auth-url<span class="token operator">=</span>http://127.0.0.1:8989 <span class="token operator">&gt;</span> gateway.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>

<span class="token comment"># wallet列表</span>
$ ./venus-gateway  wallet list
 
<span class="token comment"># miner列表</span>
$ ./venus-gateway  miner list
</code></pre></div><h3 id="venus"><a href="#venus" class="header-anchor">#</a> venus</h3> <ul><li>生成预密封文件和数据</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>$ ./venus seed pre-seal --sector-size <span class="token number">2048</span> --num-sectors <span class="token number">2</span>
$ ./venus seed genesis new localnet.json
$ ./venus seed genesis add-miner localnet.json ~/.genesis-sectors/pre-seal-t01000.json
</code></pre></div><blockquote><p><code>seed pre-seal</code> 需要root权限,请在root用户下执行</p></blockquote> <ul><li>启动venus</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>$ <span class="token function">nohup</span> ./venus daemon --make-genesis<span class="token operator">=</span>devgen.car --genesis-template<span class="token operator">=</span>localnet.json --network<span class="token operator">=</span>2k --auth-url<span class="token operator">=</span>http://127.0.0.1:8989 <span class="token operator">&gt;</span> venus.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
</code></pre></div><blockquote><p>venus作为公共服务组件需要监听不同IP时需要修改配置文件 <code>.venus/config.json</code></p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token string">&quot;apiAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/ip4/0.0.0.0/tcp/3453&quot;</span>,
</code></pre></div><h3 id="venus-message"><a href="#venus-message" class="header-anchor">#</a> venus-message</h3> <p>   venus-auth管理着其他venus模块使用的jwt令牌，以便它们在网络上安全地相互通信.为共享模块生成token。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># --perm specifies admin, sign, wirte or read permission of the token generated</span>
$ ./venus-auth token gen --perm admin <span class="token operator">&lt;</span>SHARED<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>SHARED_ADMIN_AUTH_TOKEN<span class="token operator">&gt;</span>
</code></pre></div><blockquote><p>SHARED是token名，共享组件可以随便起。</p></blockquote> <ul><li>为矿工t01000和wallet生成token</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>$ ./venus-auth user <span class="token function">add</span> --name<span class="token operator">=</span>test --miner<span class="token operator">=</span>t01000
$ ./venus-auth token gen --perm <span class="token function">write</span> <span class="token builtin class-name">test</span>
<span class="token operator">&lt;</span>USER_WRITE_AUTH_TOKEN<span class="token operator">&gt;</span>
</code></pre></div><p>查询token及user</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ ./venus-auth user list
number: <span class="token number">1</span>
name: <span class="token builtin class-name">test</span>
miner: f01000
sourceType: <span class="token number">0</span>   // miner:1
state <span class="token number">0</span>         // <span class="token number">0</span>: disable, <span class="token number">1</span>: <span class="token builtin class-name">enable</span>
comment: 
createTime: Thu, 05 Aug <span class="token number">2021</span> 09:36:00 CST
updateTime: Thu, 05 Aug <span class="token number">2021</span> 09:36:00 CST

$ ./venus-auth token list
num     name            perm            createTime              token
<span class="token number">1</span>       share-test      admin   <span class="token number">2021</span>-08-05 09:27:56     eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoic2hhcmUtdGVzdCIsInBlcm0iOiJhZG1pbiIsImV4dCI6IiJ9.q3Euz4CwlqlLCTUciT4gkee6au_zhhyUAkyTXlkG51E
<span class="token number">2</span>       <span class="token builtin class-name">test</span>            <span class="token function">write</span>   <span class="token number">2021</span>-08-05 09:36:44     eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoidGVzdCIsInBlcm0iOiJ3cml0ZSIsImV4dCI6IiJ9.X8L5SWVzoRpr5X5hEOAh17n22zOgfkla7POva0zCihY
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">nohup</span> ./venus-messager run <span class="token punctuation">\</span>
--auth-url<span class="token operator">=</span>http://127.0.0.1:8989 <span class="token punctuation">\</span>
--node-url<span class="token operator">=</span>/ip4/127.0.0.1/tcp/3453 <span class="token punctuation">\</span>
--gateway-url<span class="token operator">=</span>/ip4/127.0.0.1/tcp/45132 <span class="token punctuation">\</span>
--auth-token<span class="token operator">=</span><span class="token operator">&lt;</span>SHARED_ADMIN_AUTH_TOKEN<span class="token operator">&gt;</span> <span class="token punctuation">\</span>
--db-type<span class="token operator">=</span>sqlite <span class="token punctuation">\</span>
<span class="token operator">&gt;</span> msg.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
</code></pre></div><blockquote><p>db-type还支持mysql，配置如下：</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code>--db-type<span class="token operator">=</span>mysql --mysql-dsn <span class="token string">&quot;&lt;USER&gt;:&lt;PASSWORD&gt;@(127.0.0.1:3306)/venus_messager?parseTime=true&amp;loc=Local&amp;readTimeout=10s&amp;writeTimeout=10s&quot;</span>
</code></pre></div><h3 id="venus-miner"><a href="#venus-miner" class="header-anchor">#</a> venus-miner</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># init miner repo</span>
./venus-miner init --nettype<span class="token operator">=</span>2k --auth-api<span class="token operator">=</span>http://127.0.0.1:8989 <span class="token punctuation">\</span>
 --gateway-api<span class="token operator">=</span>/ip4/127.0.0.1/tcp/45132
 --api<span class="token operator">=</span>/ip4/127.0.0.1/tcp/3453 --token<span class="token operator">=</span><span class="token operator">&lt;</span>SHARED_ADMIN_AUTH_TOKEN<span class="token operator">&gt;</span>
 
<span class="token comment"># run </span>
<span class="token function">nohup</span> ./venus-miner run --nettype<span class="token operator">=</span>2k --nosync <span class="token operator">&gt;</span> miner.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;&amp;</span> <span class="token number">1</span> <span class="token operator">&amp;</span>

<span class="token comment"># 每次启动时会从venus-auth请求当前已加入venus分布式矿池中的miner列表,可以根据命令查询:</span>
$ ./venus-miner address state
<span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
                <span class="token string">&quot;Addr&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;f01000&quot;</span>,
                <span class="token string">&quot;IsMining&quot;</span><span class="token builtin class-name">:</span> true,
                <span class="token string">&quot;Err&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                        <span class="token string">&quot;2021-08-05 09:45:06 failed to compute proof: no connections for this miner t01000&quot;</span>
                <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><blockquote><p>因为此时我们还没有启动venus-sealer故忽略这个错误。这里我们先将出块停止，等sealer成功启动后再开始。</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code>$ ./venus-miner address stop f01000
stop mining success.
</code></pre></div><h2 id="创世节点"><a href="#创世节点" class="header-anchor">#</a> 创世节点</h2> <h3 id="venus-wallet"><a href="#venus-wallet" class="header-anchor">#</a> venus-wallet</h3> <div class="language-sh extra-class"><pre class="language-sh"><code>$ <span class="token function">nohup</span> ./venus-wallet run <span class="token operator">&gt;</span> wallet.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>

<span class="token comment"># 设置密码</span>
$ ./venus-wallet setpwd
Password:******
Enter Password again:******

<span class="token comment"># 导入钱包</span>
$ ./venus-wallet <span class="token function">import</span> ~/.genesis-sectors/pre-seal-t01000.key

<span class="token comment"># 查询</span>
$ ./venus-wallet list
t3sjhgun7xcklmyga6x3c5sq6pbncdlmrjmepfz7ms4fuqimtk4fida37dhq7kpq3tn7nyu5hpnn7mtp3a7lia
</code></pre></div><p>设置接入venus-gateway，提供签名服务</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 修改`~/.venus_wallet/config.toml`</span>
<span class="token punctuation">[</span>APIRegisterHub<span class="token punctuation">]</span>
RegisterAPI <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;/ip4/127.0.0.1/tcp/45132&quot;</span><span class="token punctuation">]</span>
Token <span class="token operator">=</span> <span class="token string">&quot;&lt;USER_WRITE_AUTH_TOKEN&gt;&quot;</span>
<span class="token comment"># 矿工集群的别名，在venus-auth中注册</span>
SupportAccounts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">]</span>
</code></pre></div><p><em><strong>保存后重启venus-wallet,需要unlock</strong></em></p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ ./venus-wallet unlock
</code></pre></div><p>查看是否成功,在venus-gateway的日志中查询:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token number">2021</span>-08-05T10:01:07.665+0800    INFO    event_stream    walletevent/wallet_conn_mgr.go:89       <span class="token function">add</span> wallet connection   <span class="token punctuation">{</span><span class="token string">&quot;channel&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;58309445-87da-4160-831a-44e5236ab3c7&quot;</span>, <span class="token string">&quot;walletName&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;test&quot;</span>, <span class="token string">&quot;addrs&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;t3sjhgun7xcklmyga6x3c5sq6pbncdlmrjmepfz7ms4fuqimtk4fida37dhq7kpq3tn7nyu5hpnn7mtp3a7lia&quot;</span><span class="token punctuation">]</span>, <span class="token string">&quot;support&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&quot;test&quot;</span>:<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>, <span class="token string">&quot;signBytes&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;6VzoKBejPzmFp/DvJzSO16s5SziYZKYjU2l2EkDUKy0=&quot;</span><span class="token punctuation">}</span>
<span class="token number">2021</span>-08-05T10:01:07.666+0800    INFO    event_stream    walletevent/wallet_event.go:79  <span class="token function">add</span> new connections <span class="token builtin class-name">test</span> <span class="token number">58309445</span>-87da-4160-831a-44e5236ab3c7
</code></pre></div><p>或用命令查询</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ ./venus-gateway wallet list
<span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
                <span class="token string">&quot;Account&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;test&quot;</span>,
                <span class="token string">&quot;SupportAccounts&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                        <span class="token string">&quot;test&quot;</span>
                <span class="token punctuation">]</span>,
                <span class="token string">&quot;ConnectStates&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                        <span class="token punctuation">{</span>
                                <span class="token string">&quot;Addrs&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                                        <span class="token string">&quot;t3sjhgun7xcklmyga6x3c5sq6pbncdlmrjmepfz7ms4fuqimtk4fida37dhq7kpq3tn7nyu5hpnn7mtp3a7lia&quot;</span>
                                <span class="token punctuation">]</span>,
                                <span class="token string">&quot;ChannelId&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;58309445-87da-4160-831a-44e5236ab3c7&quot;</span>,
                                <span class="token string">&quot;Ip&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;127.0.0.1:45138&quot;</span>,
                                <span class="token string">&quot;RequestCount&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
                                <span class="token string">&quot;CreateTime&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2021-08-05T10:01:06.261321253+08:00&quot;</span>
                        <span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
 <span class="token punctuation">]</span>
</code></pre></div><blockquote><p>上面日志即表示wallet注册服务组件成功,可提供签名服务.</p></blockquote> <h3 id="venus-sealer"><a href="#venus-sealer" class="header-anchor">#</a> venus-sealer</h3> <ul><li>初始化</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>$ ./venus-sealer init --genesis-miner --actor<span class="token operator">=</span>t01000 --sector-size<span class="token operator">=</span><span class="token number">2048</span> --pre-sealed-sectors<span class="token operator">=</span>~/.genesis-sectors --pre-sealed-metadata<span class="token operator">=</span>~/.genesis-sectors/pre-seal-t01000.json --nosync --network<span class="token operator">=</span>2k <span class="token punctuation">\</span>
--node-url<span class="token operator">=</span>/ip4/127.0.0.1/tcp/3453 <span class="token punctuation">\</span>
--messager-url<span class="token operator">=</span>/ip4/127.0.0.1/tcp/39812 <span class="token punctuation">\</span>
--gateway-url<span class="token operator">=</span>/ip4/127.0.0.1/tcp/45132 <span class="token punctuation">\</span>
--auth-token<span class="token operator">=</span><span class="token operator">&lt;</span>USER_WRITE_AUTH_TOKEN<span class="token operator">&gt;</span>
--no-local-storage
</code></pre></div><ul><li>启动</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">nohup</span> ./venus-sealer run --nosync --network<span class="token operator">=</span>2k <span class="token operator">&gt;</span> sealer.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>

$ ./venus-sealer info
Chain: <span class="token punctuation">[</span>sync behind<span class="token operator">!</span> <span class="token punctuation">(</span>15h45m53s behind<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>basefee <span class="token number">100</span> pFIL<span class="token punctuation">]</span>
Sealer: t01000 <span class="token punctuation">(</span><span class="token number">2</span> KiB sectors<span class="token punctuation">)</span>
Power: <span class="token number">40</span> Ki / <span class="token number">40</span> Ki <span class="token punctuation">(</span><span class="token number">100.0000</span>%<span class="token punctuation">)</span>
        Raw: <span class="token number">4</span> KiB / <span class="token number">4</span> KiB <span class="token punctuation">(</span><span class="token number">100.0000</span>%<span class="token punctuation">)</span>
        Committed: <span class="token number">4</span> KiB
        Proving: <span class="token number">4</span> KiB
Projected average block win rate: <span class="token number">20024.16</span>/week <span class="token punctuation">(</span>every 30s<span class="token punctuation">)</span>
Projected block win with <span class="token number">99.9</span>% probability every 41s
<span class="token punctuation">(</span>projections DO NOT account <span class="token keyword">for</span> future network and miner growth<span class="token punctuation">)</span>

Sealer Balance:    <span class="token number">3.242</span> μFIL
      PreCommit:  <span class="token number">0</span>
      Pledge:     <span class="token number">1.192</span> μFIL
      Vesting:    <span class="token number">0</span>
      Available:  <span class="token number">2.05</span> μFIL
Market Balance:   <span class="token number">0</span>
       Locked:    <span class="token number">0</span>
       Available: <span class="token number">0</span>
Worker Balance:   <span class="token number">50000000</span> FIL
Total Spendable:  <span class="token number">50000000</span> FIL

Sectors:
        Total: <span class="token number">2</span>
        Proving: <span class="token number">2</span>
</code></pre></div><p>查看是不是在服务组件注册成功</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token number">2021</span>-08-05T10:44:01.748+0800    INFO    proof_stream    proofevent/proof_event.go:71    <span class="token function">add</span> new connections 278c6798-b6ed-4062-8bde-06b8406ce06a <span class="token keyword">for</span> miner t01000
</code></pre></div><p>或</p> <div class="language- extra-class"><pre class="language-text"><code>$ ./venus-gateway miner list
t01000
</code></pre></div><ul><li>开始出块</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>$ ./venus-miner address start t01000
start mining success.
</code></pre></div><p>查看venus-miner日志</p> <div class="language- extra-class"><pre class="language-text"><code>2021-08-05T12:04:28.562+0800    INFO    miner   miner/minerwpp.go:88    GenerateWinningPoSt took 3.202841ms
2021-08-05T12:04:28.562+0800    INFO    miner   miner/warmup.go:94      winning PoSt warmup successful  {&quot;took&quot;: 0.00494326}
2021-08-05T12:04:28.695+0800    INFO    miner   miner/multiminer.go:592 attempting to mine a block      {&quot;tipset&quot;: [&quot;bafy2bzacebmqknjl3nzdqsfalfe57u6nzzg5c5uphf3ctm4p2gvdgg33lhels&quot;], &quot;miner&quot;: &quot;t01000&quot;}
2021-08-05T12:04:28.699+0800    INFO    miner   miner/multiminer.go:628 Time delta between now and our mining base: 61560s (nulls: 0), miner: t01000
2021-08-05T12:04:28.705+0800    INFO    miner   miner/minerwpp.go:72    Computing WinningPoSt ;[{SealProof:5 SectorNumber:0 SealedCID:bagboea4b5abcbicxvd7mvaigrtsinxy33tjgg6yu24brzazyfwrtoe4ca7efhkav}]; [46 110 203 67 43 156 84 228 212 143 45 167 11 151 84 34 99 202 39 85 145 136 126 180 78 134 159 125 210 112 219 223]
2021-08-05T12:04:28.707+0800    INFO    miner   miner/minerwpp.go:88    GenerateWinningPoSt took 1.802124ms
2021-08-05T12:04:28.707+0800    INFO    miner   miner/multiminer.go:704 mined new block ( -&gt; Proof)     {&quot;took&quot;: 0.012012063, &quot;miner&quot;: &quot;t01000&quot;}
2021-08-05T12:04:28.707+0800    INFO    miner   miner/multiminer.go:385 mining compute end      {&quot;number of wins&quot;: 1, &quot;total miner&quot;: 1}
2021-08-05T12:04:28.707+0800    INFO    miner   miner/multiminer.go:394 select message  {&quot;tickets&quot;: 1}
2021-08-05T12:04:28.715+0800    INFO    miner   miner/multiminer.go:420 mined new block {&quot;cid&quot;: &quot;bafy2bzacedyy2xr3bvsyfd42qzpeiprojza2yyt7wdggeawj2cmtisfjnn4lo&quot;, &quot;height&quot;: &quot;1&quot;, &quot;miner&quot;: &quot;t01000&quot;, &quot;parents&quot;: [&quot;t00&quot;], &quot;took&quot;: 0.020098632}
</code></pre></div><p>至此公共组件和创世节点搭建已经完成。</p> <div class="language- extra-class"><pre class="language-text"><code>$ ./venus chain ls
2: (2021-08-05 14:09:55) [ bafy2bzacect5pja2prfkugczbdv2jfpbou4qr3edxxr6g7oo5bny6qklzgama: t01000, ]
3: (2021-08-05 14:09:59) [ bafy2bzacedsl7eyaaiu7oifsdy6zpj2zotbcsnuml45hu5n4erdhygiyeua6s: t01000, ]
4: (2021-08-05 14:10:03) [ bafy2bzacea42xioz3ki33uw7bbjkc5ydt4qs2j55ku2aqy2box4wjcgmzxtny: t01000, ]
5: (2021-08-05 14:10:07) [ bafy2bzacecbmetsiwgms7sbukkkgzstpie5wsdwqsw5hwjqt6eqkuaq23wugs: t01000, ]
6: (2021-08-05 14:10:11) [ bafy2bzacea3ojun5fx2rpplsnevvedhgxgpvwy7afmubcvhf463hdhlfpw4ye: t01000, ]
7: (2021-08-05 14:10:15) [ bafy2bzaced4jqw2p5cejdtlfi7cq4o2treiynkp2lnhfpyss352qlbcdtknti: t01000, ]
8: (2021-08-05 14:10:19) [ bafy2bzacecpmmlobk6qrzoclzu2duy6t4irvnqryyq4libvrlh4ekz3lmihhm: t01000, ]
9: (2021-08-05 14:10:23) [ bafy2bzaceadvy5inclxdbtd2hsd72mijarkzz3rwpzznisf2yhlghushlooeg: t01000, ]
10: (2021-08-05 14:10:27) [ bafy2bzacea3rn3zuiqgp5kxbam3fc3dqnoccktpsfwaukko3amxerpjud2zns: t01000, ]
11: (2021-08-05 14:10:31) [ bafy2bzaceay2tzyd45k3e7tisbbp47gkjsrqs23jgl64wkj6jqryk4grrr7ss: t01000, ]
</code></pre></div><h2 id="普通节点"><a href="#普通节点" class="header-anchor">#</a> 普通节点</h2> <p>   普通节点和其他网络接入共享组件流程一致,可参考文档: https://venus.filecoin.io/guide/Using-venus-Shared-Modules.html#pre-requisites</p> <p>   唯一需要说明的是给普通节点钱包转账的问题:因为venus服务组件是限制Send消息的,而2k私网的原始fil在创世钱包里,故需要一个转账节点.</p> <ul><li>启动一个venus节点,仅用于转账</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code> <span class="token function">nohup</span> ./venus daemon --genesisfile<span class="token operator">=</span>devgen.car --network<span class="token operator">=</span>2k <span class="token operator">&gt;</span> venus.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
</code></pre></div><ul><li>导入创世钱包</li></ul> <div class="language- extra-class"><pre class="language-text"><code># 在venus-wallet导出钱包密钥
$ ./venus-wallet export t3sjhgun7xcklmyga6x3c5sq6pbncdlmrjmepfz7ms4fuqimtk4fida37dhq7kpq3tn7nyu5hpnn7mtp3a7lia
Password:*
7b2254797065223a22626c73222c22507269766174654b6579223a224541326e6a463363326b4f467977323079564f574b66733371794d6451767a35334c667459497347456b673d227d

# 设置密码
$ ./venus wallet set-password
Password:*
Enter Password again:*
Password set successfully 
You must REMEMBER your password! Without the password, it's impossible to decrypt the key!

# 导入钱包
$ ./venus wallet import
ipfs: Reading from /dev/stdin; send Ctrl-d to stop.

</code></pre></div><ul><li>转账</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code> ./venus send <span class="token operator">&lt;</span>to<span class="token operator">&gt;</span> <span class="token number">100</span>
</code></pre></div><p>-- 常用命令</p> <div class="language- extra-class"><pre class="language-text"><code># 查询钱包列表
$ ./venus wallet list

# 查询指定钱包余额
$ ./venus wallet balance &lt;wallet&gt;

# 设置和查询默认钱包,转账的from即是默认钱包
$ ./venus wallet default
$ ./venus wallet set-default &lt;wallet&gt;
</code></pre></div><blockquote><p>venus转账节点重启后也需要unlock,不然无法转账.</p></blockquote></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/filecoin-project/venus-docs/edit/master/docs/zh/advanced/How-To-Setup_2knet.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2021/8/6 上午10:48:55</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/zh/advanced/" class="prev router-link-active">
        venus矿池进阶
      </a></span> <span class="next"><a href="/zh/advanced/tips-running-in-China.html">
        中国部署小贴士
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.c54dbfd7.js" defer></script><script src="/assets/js/2.975ccc2c.js" defer></script><script src="/assets/js/60.376cfae0.js" defer></script>
  </body>
</html>
